/** @license sf2synth.js 2013 - imaya / GREE Inc. [ https://github.com/gree/sf2synth.js ] The MIT License */(function() {'use strict';function k(c){throw c;}var m=void 0,n=!0,u=null,v=!1,w=this;function y(c,d){var a=c.split("."),b=w;!(a[0]in b)&&b.execScript&&b.execScript("var "+a[0]);for(var f;a.length&&(f=a.shift());)!a.length&&d!==m?b[f]=d:b=b[f]?b[f]:b[f]={}};function A(c,d,a){this.c=c;this.destination=d;this.b=a;this.ea=a.channel;this.key=a.key;this.Ea=a.velocity;this.buffer=a.sample;this.playbackRate=a.basePlaybackRate;this.sampleRate=a.sampleRate;this.volume=a.volume;this.W=a.panpot;this.k=a.pitchBend;this.r=a.pitchBendSensitivity;this.ma=a.modEnvToPitch;this.startTime=c.currentTime;this.v=this.playbackRate}
A.prototype.noteOn=function(){var c=this.c,d=this.b,a=this.buffer,b,f,e,g=this.c.currentTime,h=g+d.volAttack,q=g+d.modAttack,l=h+d.volDecay,p=q+d.modDecay;f=d.loopStart/this.sampleRate;e=d.loopEnd/this.sampleRate;var r=d.start/this.sampleRate,a=a.subarray(0,a.length+d.end);b=this.ca=c.createBuffer(1,a.length,this.sampleRate);b.getChannelData(0).set(a);a=this.u=c.createBufferSource();a.buffer=b;a.loop=9!==this.ea;a.loopStart=f;a.loopEnd=e;B(this,this.k);b=this.qa=c.createPanner();f=this.M=c.createGainNode();
e=f.gain;c=this.filter=c.createBiquadFilter();c.type=c.LOWPASS;b.panningModel=0;b.setPosition(Math.sin(this.W*Math.PI/2),0,Math.cos(this.W*Math.PI/2));e.setValueAtTime(0,g);e.linearRampToValueAtTime(this.volume*(this.Ea/127),h);e.linearRampToValueAtTime(this.volume*(1-d.volSustain),l);c.Q.setValueAtTime(d.initialFilterQ*Math.pow(10,200),g);h=440*Math.pow(2,(d.initialFilterFc-6900)/1200);l=440*Math.pow(2,(d.initialFilterFc+d.modEnvToFilterFc-6900)/1200);d=h+(l-h)*(1-d.modSustain);c.frequency.setValueAtTime(h,
g);c.frequency.linearRampToValueAtTime(l,q);c.frequency.linearRampToValueAtTime(d,p);a.connect(c);c.connect(b);b.connect(f);f.connect(this.destination);a.start(0,r)};
A.prototype.noteOff=function(){var c=this.b,d=this.u,a=this.M,b=this.c.currentTime,f=b+c.volRelease,b=b+c.modRelease;this.ca&&(a.gain.cancelScheduledValues(0),a.gain.linearRampToValueAtTime(0,f),d.playbackRate.cancelScheduledValues(0),d.playbackRate.linearRampToValueAtTime(this.v,b),d.loop=v,d.stop(f),setTimeout(function(a){return function(){a.u.disconnect(0);a.qa.disconnect(0);a.M.disconnect(0)}}(this),1E3*c.volRelease))};
function B(c,d){c.v=c.playbackRate*Math.pow(Math.pow(2,1/12),c.r*(d/(0>d?8192:8191))*c.b.scaleTuning);var a=c.u.playbackRate,b=c.v,f=c.startTime,e=c.b,g=f+e.modAttack,h=g+e.modDecay,q=b*Math.pow(Math.pow(2,1/12),c.ma*c.b.scaleTuning);a.cancelScheduledValues(0);a.setValueAtTime(b,f);a.linearRampToValueAtTime(q,g);a.linearRampToValueAtTime(b+(q-b)*(1-e.modSustain),h)};function D(c,d){d=d||{};this.input=c;this.i=d.index||0;this.length=d.length||c.length-this.i;this.offset=this.i;this.padding=d.padding!==m?d.padding:n;this.da=d.bigEndian!==m?d.bigEndian:v}function ba(c,d,a){this.type=c;this.size=d;this.offset=a}
D.prototype.parse=function(){var c=this.length+this.offset;for(this.e=[];this.i<c;){var d=this.input,a=this.i,b=m;this.e.push(new ba(String.fromCharCode(d[a++],d[a++],d[a++],d[a++]),b=this.da?(d[a++]<<24|d[a++]<<16|d[a++]<<8|d[a++])>>>0:(d[a++]|d[a++]<<8|d[a++]<<16|d[a++]<<24)>>>0,a));a+=b;this.padding&&1===(a-this.offset&1)&&a++;this.i=a}};function E(c,d){var a=c.e[d];return a===m?u:a};function J(c,d){d=d||{};this.input=c;this.ra=d.parserOption}
J.prototype.parse=function(){var c,d,a=new D(this.input,this.ra);a.parse();1!==a.e.length&&k(Error("wrong chunk length"));a=E(a,0);a===u&&k(Error("chunk not found"));var b=this.input,f=a.offset,e;"RIFF"!==a.type&&k(Error("invalid chunk type:"+a.type));e=String.fromCharCode(b[f++],b[f++],b[f++],b[f++]);"sfbk"!==e&&k(Error("invalid signature:"+e));a=new D(b,{index:f,length:a.size-4});a.parse();3!==a.e.length&&k(Error("invalid sfbk structure"));b=E(a,0);f=this.input;e=b.offset;var g;"LIST"!==b.type&&
k(Error("invalid chunk type:"+b.type));g=String.fromCharCode(f[e++],f[e++],f[e++],f[e++]);"INFO"!==g&&k(Error("invalid signature:"+g));(new D(f,{index:e,length:b.size-4})).parse();b=E(a,1);f=this.input;e=b.offset;"LIST"!==b.type&&k(Error("invalid chunk type:"+b.type));g=String.fromCharCode(f[e++],f[e++],f[e++],f[e++]);"sdta"!==g&&k(Error("invalid signature:"+g));b=new D(f,{index:e,length:b.size-4});b.parse();1!==b.e.length&&k(Error("TODO"));this.ba=E(b,0);a=E(a,2);b=this.input;f=a.offset;"LIST"!==
a.type&&k(Error("invalid chunk type:"+a.type));e=String.fromCharCode(b[f++],b[f++],b[f++],b[f++]);"pdta"!==e&&k(Error("invalid signature:"+e));a=new D(b,{index:f,length:a.size-4});a.parse();9!==a.e.length&&k(Error("invalid pdta chunk"));b=E(a,0);f=this.input;e=b.offset;g=this.ua=[];var h=b.offset+b.size;for("phdr"!==b.type&&k(Error("invalid chunk type:"+b.type));e<h;)g.push({va:String.fromCharCode.apply(u,f.subarray(e,e+=20)),ta:f[e++]|f[e++]<<8,l:f[e++]|f[e++]<<8,Y:f[e++]|f[e++]<<8,Ha:(f[e++]|f[e++]<<
8|f[e++]<<16|f[e++]<<24)>>>0,Fa:(f[e++]|f[e++]<<8|f[e++]<<16|f[e++]<<24)>>>0,Ia:(f[e++]|f[e++]<<8|f[e++]<<16|f[e++]<<24)>>>0});b=E(a,1);f=this.input;e=b.offset;g=this.wa=[];h=b.offset+b.size;for("pbag"!==b.type&&k(Error("invalid chunk type:"+b.type));e<h;)g.push({Z:f[e++]|f[e++]<<8,A:f[e++]|f[e++]<<8});b=E(a,2);"pmod"!==b.type&&k(Error("invalid chunk type:"+b.type));this.aa=K(this,b);b=E(a,3);"pgen"!==b.type&&k(Error("invalid chunk type:"+b.type));this.$=L(this,b);b=E(a,4);f=this.input;e=b.offset;
g=this.b=[];h=b.offset+b.size;for("inst"!==b.type&&k(Error("invalid chunk type:"+b.type));e<h;)g.push({ja:String.fromCharCode.apply(u,f.subarray(e,e+=20)),O:f[e++]|f[e++]<<8});b=E(a,5);f=this.input;e=b.offset;g=this.ka=[];h=b.offset+b.size;for("ibag"!==b.type&&k(Error("invalid chunk type:"+b.type));e<h;)g.push({P:f[e++]|f[e++]<<8,ia:f[e++]|f[e++]<<8});b=E(a,6);"imod"!==b.type&&k(Error("invalid chunk type:"+b.type));this.S=K(this,b);b=E(a,7);"igen"!==b.type&&k(Error("invalid chunk type:"+b.type));
this.R=L(this,b);h=E(a,8);a=this.input;b=h.offset;f=this.ya=[];e=this.za=[];g=h.offset+h.size;var q,l,p,r,s,t,F;for("shdr"!==h.type&&k(Error("invalid chunk type:"+h.type));b<g;){h=String.fromCharCode.apply(u,a.subarray(b,b+=20));d=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;c=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;q=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;l=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;p=(a[b++]<<0|a[b++]<<8|a[b++]<<16|a[b++]<<24)>>>0;r=a[b++];s=a[b++]<<24>>
24;t=a[b++]|a[b++]<<8;F=a[b++]|a[b++]<<8;c=new Int16Array((new Uint8Array(a.subarray(this.ba.offset+2*d,this.ba.offset+2*c))).buffer);q-=d;l-=d;if(0<p){var x=p,C=m,z=m,I=m,G=m;for(d=1;22050>x;){C=new Int16Array(2*c.length);z=G=0;for(I=c.length;z<I;++z)C[G++]=c[z],C[G++]=c[z];c=C;d*=2;x*=2}p*=d;q*=d;l*=d}f.push(c);e.push({Ka:h,Ca:q,ga:l,sampleRate:p,pa:r,sa:s,Ja:t,La:F})}this.input=u};
function K(c,d){for(var a=c.input,b=d.offset,f=d.offset+d.size,e,g,h=[];b<f;){b+=2;e=a[b++]|a[b++]<<8;g=M[e];if(g===m)h.push({type:g,value:{code:e,d:a[b]|a[b+1]<<8<<16>>16,j:a[b++],h:a[b++]}});else switch(g){case "keyRange":case "velRange":case "keynum":case "velocity":h.push({type:g,value:{j:a[b++],h:a[b++]}});break;default:h.push({type:g,value:{d:a[b++]|a[b++]<<8<<16>>16}})}b+=2;b+=2}return h}
function L(c,d){for(var a=c.input,b=d.offset,f=d.offset+d.size,e,g,h=[];b<f;)if(e=a[b++]|a[b++]<<8,g=M[e],g===m)h.push({type:g,value:{code:e,d:a[b]|a[b+1]<<8<<16>>16,j:a[b++],h:a[b++]}});else switch(g){case "keynum":case "keyRange":case "velRange":case "velocity":h.push({type:g,value:{j:a[b++],h:a[b++]}});break;default:h.push({type:g,value:{d:a[b++]|a[b++]<<8<<16>>16}})}return h}
function N(c,d,a){var b=[],f={Da:[],keyRange:{h:127,j:0}},e;for(e=c;e<d;++e)c=a[e],b.push(c),"unknown"===c.type?f.Da.push(c.value):f[c.type]=c.value;return{p:f,q:b}}
var M=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",,"chorusEffectsSend","reverbEffectsSend","pan",,,,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay",
"delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",,"scaleTuning","exclusiveClass","overridingRootKey"];function Q(c){this.input=c;this.l=0;this.bufferSize=1024;var d;w.AudioContext!==m?d=new w.AudioContext:w.webkitAudioContext!==m?d=new w.webkitAudioContext:w.mozAudioContext!==m?d=new w.mozAudioContext:k(Error("Web Audio not supported"));d.createGainNode===m&&(d.createGainNode=d.createGain);this.c=d;this.f=this.c.createGainNode();this.fa=this.c.createDynamicsCompressor();this.t=this.c.createBufferSource();this.g=[0,1,2,3,4,5,6,7,8,0,10,11,12,13,14,15];this.K=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];this.H=
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.n=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];this.G=1/32768;this.V=16384;this.m=[0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0];this.F=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.z=v}var ca="Acoustic Piano;Bright Piano;Electric Grand Piano;Honky-tonk Piano;Electric Piano;Electric Piano 2;Harpsichord;Clavi;Celesta;Glockenspiel;Musical box;Vibraphone;Marimba;Xylophone;Tubular Bell;Dulcimer;Drawbar Organ;Percussive Organ;Rock Organ;Church organ;Reed organ;Accordion;Harmonica;Tango Accordion;Acoustic Guitar (nylon);Acoustic Guitar (steel);Electric Guitar (jazz);Electric Guitar (clean);Electric Guitar (muted);Overdriven Guitar;Distortion Guitar;Guitar harmonics;Acoustic Bass;Electric Bass (finger);Electric Bass (pick);Fretless Bass;Slap Bass 1;Slap Bass 2;Synth Bass 1;Synth Bass 2;Violin;Viola;Cello;Double bass;Tremolo Strings;Pizzicato Strings;Orchestral Harp;Timpani;String Ensemble 1;String Ensemble 2;Synth Strings 1;Synth Strings 2;Voice Aahs;Voice Oohs;Synth Voice;Orchestra Hit;Trumpet;Trombone;Tuba;Muted Trumpet;French horn;Brass Section;Synth Brass 1;Synth Brass 2;Soprano Sax;Alto Sax;Tenor Sax;Baritone Sax;Oboe;English Horn;Bassoon;Clarinet;Piccolo;Flute;Recorder;Pan Flute;Blown Bottle;Shakuhachi;Whistle;Ocarina;Lead 1 (square);Lead 2 (sawtooth);Lead 3 (calliope);Lead 4 (chiff);Lead 5 (charang);Lead 6 (voice);Lead 7 (fifths);Lead 8 (bass + lead);Pad 1 (Fantasia);Pad 2 (warm);Pad 3 (polysynth);Pad 4 (choir);Pad 5 (bowed);Pad 6 (metallic);Pad 7 (halo);Pad 8 (sweep);FX 1 (rain);FX 2 (soundtrack);FX 3 (crystal);FX 4 (atmosphere);FX 5 (brightness);FX 6 (goblins);FX 7 (echoes);FX 8 (sci-fi);Sitar;Banjo;Shamisen;Koto;Kalimba;Bagpipe;Fiddle;Shanai;Tinkle Bell;Agogo;Steel Drums;Woodblock;Taiko Drum;Melodic Tom;Synth Drum;Reverse Cymbal;Guitar Fret Noise;Breath Noise;Seashore;Bird Tweet;Telephone Ring;Helicopter;Applause;Gunshot".split(";");
function R(c){var d,a,b,f,e;c=c.X;c.parse();var g=c.ua,h=c.wa,q=[],l,p,r,s,t;s=0;for(t=g.length;s<t;++s){l=g[s].Y;p=g[s+1]?g[s+1].Y:h.length;for(r=[];l<p;++l)e=N(h[l].Z,h[l+1]?h[l+1].Z:c.$.length,c.$),b=e.p,d=e.q,f=N(h[l].A,h[l+1]?h[l+1].A:c.aa.length,c.aa),e=f.p,f=f.q,r.push({N:b,ha:d,na:e,oa:f}),b=b.instrument!==m?b.instrument.d:e.instrument!==m?e.instrument.d:u;q.push({name:g[s].va,info:r,o:g[s],b:b})}h=c.b;r=c.ka;g=[];t=0;for(l=h.length;t<l;++t){p=h[t].O;b=h[t+1]?h[t+1].O:r.length;s=[];for(e=
b;p<e;++p)d=N(r[p].P,r[p+1]?r[p+1].P:c.R.length,c.R),b=d.p,f=d.q,a=N(r[p].A,r[p+1]?r[p+1].ia:c.S.length,c.S),d=a.p,a=a.q,s.push({N:b,ha:f,na:d,oa:a});g.push({name:h[t].ja,info:s})}h=[];l=0;for(p=q.length;l<p;++l)if(b=q[l],t=b.o.ta,"number"===typeof b.b&&(s=g[b.b],"EOI"!==s.name.replace(/\0*$/,""))){h[b.o.l]===m&&(h[b.o.l]=[]);r=h[b.o.l];r[t]=[];r[t].name=b.name;b=0;for(e=s.info.length;b<e;++b){d=c;f=r[t];a=s.info[b].N;var F=m,x=m,C=m,z=m,I=m,G=m,W=m,X=m,Y=m,Z=m,$=m,O=m,P=m,H=m,aa=m;if(!(a.keyRange===
m||a.sampleID===m)){C=S(a,"attackVolEnv",-12E3);z=S(a,"decayVolEnv",-12E3);I=S(a,"sustainVolEnv");G=S(a,"releaseVolEnv",-12E3);W=S(a,"attackModEnv",-12E3);X=S(a,"decayModEnv",-12E3);Y=S(a,"sustainModEnv");Z=S(a,"releaseModEnv",-12E3);$=S(a,"coarseTune")+S(a,"fineTune")/100;O=S(a,"scaleTuning",100)/100;P=S(a,"freqVibLFO");H=a.keyRange.j;for(aa=a.keyRange.h;H<=aa;++H)f[H]||(F=S(a,"sampleID"),x=d.za[F],f[H]={sample:d.ya[F],sampleRate:x.sampleRate,basePlaybackRate:Math.pow(Math.pow(2,1/12),(H-S(a,"overridingRootKey",
x.pa)+$+x.sa/100)*O),modEnvToPitch:S(a,"modEnvToPitch")/100,scaleTuning:O,start:32768*S(a,"startAddrsCoarseOffset")+S(a,"startAddrsOffset"),end:32768*S(a,"endAddrsCoarseOffset")+S(a,"endAddrsOffset"),loopStart:x.Ca+32768*S(a,"startloopAddrsCoarseOffset")+S(a,"startloopAddrsOffset"),loopEnd:x.ga+32768*S(a,"endloopAddrsCoarseOffset")+S(a,"endloopAddrsOffset"),volAttack:Math.pow(2,C/1200),volDecay:Math.pow(2,z/1200),volSustain:I/1E3,volRelease:Math.pow(2,G/1200),modAttack:Math.pow(2,W/1200),modDecay:Math.pow(2,
X/1200),modSustain:Y/1E3,modRelease:Math.pow(2,Z/1200),initialFilterFc:S(a,"initialFilterFc",13500),modEnvToFilterFc:S(a,"modEnvToFilterFc"),initialFilterQ:S(a,"initialFilterQ"),freqVibLFO:P?8.176*Math.pow(2,P/1200):m})}}}return h}function S(c,d,a){a===m&&(a=0);return c[d]?c[d].d:a}Q.prototype.start=function(){this.t.connect(this.f);this.f.connect(this.c.destination);this.t.start(0);this.V=16383;this.f.gain.value=this.G*(16383/16384)};
Q.prototype.stop=function(){this.t.disconnect(0);this.f.disconnect(0);this.fa.disconnect(0)};var T=["Instrument","Vol","Pan","Bend","Range"];
function da(c){var d=c.a=document.createElement("table"),a=document.createElement("thead"),b=document.createElement("tbody"),f,e,g;a.appendChild(ea(T,n));for(e=0;16>e;++e){f=ea(T.length+128,v);b.appendChild(f);if(9!==e){var h=document.createElement("select"),q;for(g=0;128>g;++g)q=document.createElement("option"),q.textContent=ca[g],h.appendChild(q);f.querySelector("td:nth-child(1)").appendChild(h);h.addEventListener("change",function(a,b){return function(c){U(a,b,c.target.selectedIndex)}}(c,e),v);
h.selectedIndex=c.g[e]}else f.querySelector("td:first-child").textContent="[ RHYTHM TRACK ]";f=f.querySelectorAll("td:nth-last-child(-n+128)");for(g=0;128>g;++g)f[g].addEventListener("mousedown",function(a,b,c){return function(d){d.preventDefault();a.L=n;a.noteOn(b,c,127)}}(c,e,g)),f[g].addEventListener("mouseover",function(a,b,c){return function(d){d.preventDefault();a.L&&a.noteOn(b,c,127)}}(c,e,g)),f[g].addEventListener("mouseout",function(a,b,c){return function(d){d.preventDefault();a.noteOff(b,
c,0)}}(c,e,g)),f[g].addEventListener("mouseup",function(a,b,c){return function(d){d.preventDefault();a.L=v;a.noteOff(b,c,0)}}(c,e,g))}d.appendChild(a);d.appendChild(b);return d}function ea(c,d){var a=document.createElement("tr"),b,f=c instanceof Array,e,g=f?c.length:c;for(e=0;e<g;++e)b=document.createElement(d?"th":"td"),b.textContent=f&&c[e]!==m?c[e]:"",a.appendChild(b);return a}
Q.prototype.noteOn=function(c,d,a){var b=b=this.m[c];this.z?9==c&&(b=127):9==c&&(b=128);var f=this.s[b],e=f[this.g[c]],g;this.a&&this.a.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child("+(T.length+d+1)+")").classList.add("note-on");e||(e=f[b]);try{g=e[d]}catch(h){g=f[0]}g?(b=this.H[c]-64,g.channel=c,g.key=d,g.velocity=a,g.panpot=b/(0>b?64:63),g.volume=this.K[c]/127*(this.w[c]/127),g.pitchBend=this.I[c]-8192,g.pitchBendSensitivity=this.J[c],d=new A(this.c,this.f,g),d.noteOn(),this.n[c].push(d)):
w.console.warn("instrument not found: bank=%s instrument=%s channel=%s key=%s",b,this.g[c],c,d)};Q.prototype.noteOff=function(c,d){var a=this.m[c];this.z?9==c&&(a=127):9==c&&(a=128);var b=this.s[a][this.g[c]],f,a=this.n[c],e;this.a&&this.a.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child("+(d+T.length+1)+")").classList.remove("note-on");if(b){b=0;for(f=a.length;b<f;++b)e=a[b],e.key===d&&(e.noteOff(),a.splice(b,1),--b,--f)}};
function U(c,d,a){c.a&&9!==d&&(c.a.querySelector("tbody > tr:nth-child("+(d+1)+") > td:first-child > select").selectedIndex=a);c.g[d]=a}function fa(c,d,a){c.a&&(c.a.querySelector("tbody > tr:nth-child("+(d+1)+") > td:nth-child(2)").textContent=a);c.K[d]=a}function ga(c,d,a){c.a&&(c.a.querySelector("tbody > tr:nth-child("+(d+1)+") > td:nth-child(3)").textContent=a);c.H[d]=a}
Q.prototype.k=function(c,d,a){d=d&127|(a&127)<<7;var b,f=this.n[c],e=d-8192;this.a&&(this.a.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child(4)").textContent=e);a=0;for(b=f.length;a<b;++a)B(f[a],e);this.I[c]=d};Q.prototype.r=function(c,d){this.a&&(this.a.querySelector("tbody > tr:nth-child("+(c+1)+") > td:nth-child(5)").textContent=d);this.J[c]=d};function V(){this.D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.la=this.onmessage.bind(this);window.addEventListener("DOMContentLoaded",function(){this.xa=n}.bind(this),v)}V.prototype.Ba=function(c){this.xa?this.load(c):window.addEventListener("DOMContentLoaded",function a(){window.removeEventListener("DOMContentLoaded",a,v);this.load(c)}.bind(this),v)};
V.prototype.load=function(c){var d=new XMLHttpRequest;d.open("GET",c,n);d.responseType="arraybuffer";d.addEventListener("load",function(a){a=a.target;this.onload(a.response);"function"===typeof this.T&&this.T(a.response)}.bind(this),v);d.addEventListener("progress",function(a){a.lengthComputable&&(a=a.loaded/a.total,document.getElementById("message")&&(document.getElementById("message").firstChild.nodeValue="Now Loading..."+a+"%"))},v);d.send()};
V.prototype.onload=function(c){c=new Uint8Array(c);this.U(c)};
V.prototype.U=function(c){var d;if(this.B)d=this.B,d.input=c,d.X=new J(c),d.s=R(d);else{d=this.B=new Q(c);document.body.appendChild(da(d));c=d;var a;c.X=new J(c.input);c.s=R(c);for(a=0;16>a;++a)U(c,a,a),fa(c,a,100),ga(c,a,64),c.w[a]=127,c.k(a,0,64),c.r(a,2),c.m[a]=0,c.F[a]=0;d.start();window.addEventListener("message",this.la,v)}window.opener?window.opener.postMessage("link,ready","*"):window.parent!==window&&window.parent.postMessage("link,ready","*")};
V.prototype.onmessage=function(c){c=c.data.split(",");switch(c.shift()){case "midi":ha(this,c.map(function(c){return parseInt(c,16)}));break;case "link":c=c.shift();switch(c){case "reqpatch":window.opener?window.opener.postMessage("link,patch","*"):window.parent!==window&&window.parent.postMessage("link,patch","*");break;case "setpatch":break;default:w.console.error("unknown link message:",c)}break;default:w.console.error("unknown message type")}};V.prototype.Aa=function(c){this.T=c};
function ha(c,d){var a=d[0]&15,b=c.B;switch(d[0]&240){case 128:b.noteOff(a,d[1],d[2]);break;case 144:0<d[2]?b.noteOn(a,d[1],d[2]):b.noteOff(a,d[1],0);break;case 176:switch(d[1]){case 0:b.m[a]=d[2];break;case 6:switch(c.D[a]){case 0:switch(c.C[a]){case 0:b.r(a,d[2])}}break;case 7:fa(b,a,d[2]);break;case 10:ga(b,a,d[2]);break;case 11:b.w[a]=d[2];break;case 32:b.F[a]=d[2];break;case 120:for(var f=b.n[a];0<f.length;)b.noteOff(a,f[0].key,0);break;case 121:b.k(a,0,64);break;case 100:c.D[a]=d[2];break;case 101:c.C[a]=
d[2]}break;case 192:U(b,a,d[1]);break;case 224:b.k(a,d[1],d[2]);break;case 240:switch(d[1]){case 127:switch(d[3]){case 4:switch(d[4]){case 1:a=d[5]+(d[6]<<7),b.V=a,b.f.gain.value=b.G*(a/16384)}}}switch(d[2]){case 67:126==d[7]&&(b.z=n);break;case 65:b.Ga=n}}};y("SoundFont.WebMidiLink",V);y("SoundFont.WebMidiLink.prototype.setup",V.prototype.Ba);y("SoundFont.WebMidiLink.prototype.loadSoundFont",V.prototype.U);y("SoundFont.WebMidiLink.prototype.setLoadCallback",V.prototype.Aa);}).call(this); //@ sourceMappingURL=sf2synth.min.js.map
