/** @license sf2synth.js 2013 - imaya / GREE Inc. [ https://github.com/gree/sf2synth.js ], 2013-2017 - Logue [ https://github.com/logue/sf2synth.js ] The MIT License */(function() {'use strict';var m,r=this;
function u(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}function w(a,b){a=a.split(".");var c=r;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)a.length||void 0===b?c[e]&&c[e]!==Object.prototype[e]?c=c[e]:c=c[e]={}:c[e]=b};var aa="Acoustic Piano;Bright Acoustic Piano;Electric Grand Piano;Honky-tonk Piano;Electric Piano;Electric Piano 2;Harpsichord;Clavi;Celesta;Glockenspiel;Musical box;Vibraphone;Marimba;Xylophone;Tubular Bell;Dulcimer;Drawbar Organ;Percussive Organ;Rock Organ;Church organ;Reed organ;Accordion;Harmonica;Tango Accordion;Acoustic Guitar (nylon);Acoustic Guitar (steel);Electric Guitar (jazz);Electric Guitar (clean);Electric Guitar (muted);Overdriven Guitar;Distortion Guitar;Guitar Harmonics;Acoustic Bass;Electric Bass (finger);Electric Bass (pick);Fretless Bass;Slap Bass 1;Slap Bass 2;Synth Bass 1;Synth Bass 2;Violin;Viola;Cello;Double bass;Tremolo Strings;Pizzicato Strings;Orchestral Harp;Timpani;String Ensemble 1;String Ensemble 2;Synth Strings 1;Synth Strings 2;Voice Aahs;Voice Oohs;Synth Voice;Orchestra Hit;Trumpet;Trombone;Tuba;Muted Trumpet;French horn;Brass Section;Synth Brass 1;Synth Brass 2;Soprano Sax;Alto Sax;Tenor Sax;Baritone Sax;Oboe;English Horn;Bassoon;Clarinet;Piccolo;Flute;Recorder;Pan Flute;Blown Bottle;Shakuhachi;Whistle;Ocarina;Lead 1 (square);Lead 2 (sawtooth);Lead 3 (calliope);Lead 4 (chiff);Lead 5 (charang);Lead 6 (voice);Lead 7 (fifths);Lead 8 (bass + lead);Pad 1 (new age);Pad 2 (warm);Pad 3 (polysynth);Pad 4 (choir);Pad 5 (bowed);Pad 6 (metallic);Pad 7 (halo);Pad 8 (sweep);FX 1 (rain);FX 2 (soundtrack);FX 3 (crystal);FX 4 (atmosphere);FX 5 (brightness);FX 6 (goblins);FX 7 (echoes);FX 8 (sci-fi);Sitar;Banjo;Shamisen;Koto;Kalimba;Bagpipe;Fiddle;Shanai;Tinkle Bell;Agogo;Steel Drums;Woodblock;Taiko Drum;Melodic Tom;Synth Drum;Reverse Cymbal;Guitar Fret Noise;Breath Noise;Seashore;Bird Tweet;Telephone Ring;Helicopter;Applause;Gunshot".split(";"),
A="Standard Set;;;;;;;;Room Set;;;;;;;;Power Set;;;;;;;;Electronic Set;Analog Set;;;;;;;Jazz Set;;;;;;;;Brush Set;;;;;;;;Orchestra Set;;;;;;;;SFX Set;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;".split(";");function B(a,b){this.b=a;this.a=b||{};this.f=this.b.createGain();this.h=this.f.a=this.b.createGain();this.i=this.b.createGain();this.g=this.b.createGain();this.j=this.b.createConvolver();this.c=this.b.createBiquadFilter();this.f.connect(this.g);this.f.connect(this.i);this.j.connect(this.c);this.g.connect(this.h);this.i.connect(this.h);this.c.connect(this.f);for(var c in ba)this.a[c]=void 0===this.a[c]?ba[c]:this.a[c];this.g.gain.value=ca(this.a.K);this.i.gain.value=da(this.a.K);this.c.J=this.a.J;
this.c.frequency=this.a.aa;this.j.gain=1;F(this);return this.f}var ba={aa:350,N:2,O:0,J:"lowpass",K:.5,reverse:!1,time:3};
function F(a){var b=a.b.sampleRate,c=Math.max(b*a.a.time,1),e=b*a.a.O;b=a.b.createBuffer(2,c,b);var d=new Float32Array(c),f=new Float32Array(c),g;for(g=0;g<c;g++){var h=a.a.reverse?c-(g-e):g-e;h=Math.pow(1-h/c,a.a.N);d[g]=(2*Math.random()-1)*h;f[g]=(2*Math.random()-1)*h}b.getChannelData(0).set(d);b.getChannelData(1).set(f);console.info("Update impulse responce.");a.j.buffer=b}m=B.prototype;m.connect=function(a){r.console.info("Connect Reverb.");this.h.connect(a.input?a.input:a)};
m.disconnect=function(a){r.console.info("Disconnect Reverb.");this.h.disconnect(a)};m.K=function(a){this.a.K=a;this.g.gain.value=ca(a);this.i.gain.value=da(a)};m.time=function(a){this.a.time=a;F(this)};m.N=function(a){this.a.N=a;F(this)};m.O=function(a){this.a.O=a;F(this)};m.reverse=function(a){a&&(this.a.reverse=a,F(this))};m.aa=function(a){this.c.frequency=this.a.filter.frequency=a};m.J=function(a){this.c.J=this.a.filter.type=a};function ca(a){return 1<a||0>a?0:.5>=a?1:1-2*(a-.5)}
function da(a){return 1<a||0>a?0:.5<=a?1:1-2*(a-.5)};function G(a,b){b=b||{};this.input=a;this.b=b.index||0;this.length=b.length||a.length-this.b;this.offset=this.b;this.c=void 0!==b.padding?b.padding:!0;this.f=void 0!==b.bigEndian?b.bigEndian:!1}function ea(a,b,c){this.type=a;this.a=b;this.offset=c}
G.prototype.parse=function(){var a=this.length+this.offset;for(this.a=[];this.b<a;){var b=this.input;var c=this.b;this.a.push(new ea(String.fromCharCode(b[c++],b[c++],b[c++],b[c++]),b=this.f?(b[c++]<<24|b[c++]<<16|b[c++]<<8|b[c++])>>>0:(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,c));c+=b;this.c&&1===(c-this.offset&1)&&c++;this.b=c}};function H(a,b){a=a.a[b];return void 0===a?null:a};function J(a,b){b=b||{};this.input=a;this.xa=b.parserOption;this.sampleRate=b.sampleRate||22050}
J.prototype.parse=function(){var a,b=new G(this.input,this.xa);b.parse();if(1!==b.a.length)throw Error("wrong chunk length");b=H(b,0);if(null===b)throw Error("chunk not found");var c=this.input,e=b.offset;if("RIFF"!==b.type)throw Error("invalid chunk type:"+b.type);var d=String.fromCharCode(c[e++],c[e++],c[e++],c[e++]);if("sfbk"!==d)throw Error("invalid signature:"+d);b=new G(c,{index:e,length:b.a-4});b.parse();if(3!==b.a.length)throw Error("invalid sfbk structure");c=H(b,0);e=this.input;d=c.offset;
if("LIST"!==c.type)throw Error("invalid chunk type:"+c.type);var f=String.fromCharCode(e[d++],e[d++],e[d++],e[d++]);if("INFO"!==f)throw Error("invalid signature:"+f);(new G(e,{index:d,length:c.a-4})).parse();c=H(b,1);e=this.input;d=c.offset;if("LIST"!==c.type)throw Error("invalid chunk type:"+c.type);f=String.fromCharCode(e[d++],e[d++],e[d++],e[d++]);if("sdta"!==f)throw Error("invalid signature:"+f);c=new G(e,{index:d,length:c.a-4});c.parse();if(1!==c.a.length)throw Error("TODO");this.na=H(c,0);b=
H(b,2);c=this.input;e=b.offset;if("LIST"!==b.type)throw Error("invalid chunk type:"+b.type);d=String.fromCharCode(c[e++],c[e++],c[e++],c[e++]);if("pdta"!==d)throw Error("invalid signature:"+d);b=new G(c,{index:e,length:b.a-4});b.parse();if(9!==b.a.length)throw Error("invalid pdta chunk");c=H(b,0);e=this.input;d=c.offset;f=this.Aa=[];var g=c.offset+c.a;if("phdr"!==c.type)throw Error("invalid chunk type:"+c.type);for(;d<g;)f.push({Ba:String.fromCharCode.apply(null,e.subarray(d,d+=20)),za:e[d++]|e[d++]<<
8,$:e[d++]|e[d++]<<8,ja:e[d++]|e[d++]<<8,Ka:(e[d++]|e[d++]<<8|e[d++]<<16|e[d++]<<24)>>>0,Ja:(e[d++]|e[d++]<<8|e[d++]<<16|e[d++]<<24)>>>0,La:(e[d++]|e[d++]<<8|e[d++]<<16|e[d++]<<24)>>>0});c=H(b,1);e=this.input;d=c.offset;f=this.Ca=[];g=c.offset+c.a;if("pbag"!==c.type)throw Error("invalid chunk type:"+c.type);for(;d<g;)f.push({ka:e[d++]|e[d++]<<8,R:e[d++]|e[d++]<<8});c=H(b,2);if("pmod"!==c.type)throw Error("invalid chunk type:"+c.type);this.ma=fa(this,c);c=H(b,3);if("pgen"!==c.type)throw Error("invalid chunk type:"+
c.type);this.la=ha(this,c);c=H(b,4);e=this.input;d=c.offset;f=this.l=[];g=c.offset+c.a;if("inst"!==c.type)throw Error("invalid chunk type:"+c.type);for(;d<g;)f.push({ta:String.fromCharCode.apply(null,e.subarray(d,d+=20)),ea:e[d++]|e[d++]<<8});c=H(b,5);e=this.input;d=c.offset;f=this.ua=[];g=c.offset+c.a;if("ibag"!==c.type)throw Error("invalid chunk type:"+c.type);for(;d<g;)f.push({fa:e[d++]|e[d++]<<8,sa:e[d++]|e[d++]<<8});c=H(b,6);if("imod"!==c.type)throw Error("invalid chunk type:"+c.type);this.ha=
fa(this,c);c=H(b,7);if("igen"!==c.type)throw Error("invalid chunk type:"+c.type);this.ga=ha(this,c);g=H(b,8);b=this.input;c=g.offset;e=this.Da=[];d=this.Ea=[];f=g.offset+g.a;if("shdr"!==g.type)throw Error("invalid chunk type:"+g.type);for(;c<f;){g=String.fromCharCode.apply(null,b.subarray(c,c+=20));var h=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var k=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var n=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var p=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<
24)>>>0;var q=(b[c++]<<0|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;var x=b[c++];var t=b[c++]<<24>>24;var C=b[c++]|b[c++]<<8;var z=b[c++]|b[c++]<<8;var l=new Int16Array((new Uint8Array(b.subarray(this.na.offset+2*h,this.na.offset+2*k))).buffer);n-=h;p-=h;if(0<q){var D,v=l,y=q;for(a=1;y<this.sampleRate;){var I=new Int16Array(2*v.length);var E=l=0;for(D=v.length;E<D;++E)I[l++]=v[E],I[l++]=v[E];v=I;a*=2;y*=2}l=v;q*=a;n*=a;p*=a}e.push(l);d.push({Na:g,start:h,end:k,Ha:n,qa:p,sampleRate:q,wa:x,ya:t,Ma:C,Oa:z})}this.input=
null};function fa(a,b){a=a.input;var c=b.offset;b=b.offset+b.a;for(var e,d,f=[];c<b;){c+=2;e=a[c++]|a[c++]<<8;d=ia[e];if(void 0===d)f.push({type:d,value:{code:e,s:a[c]|a[c+1]<<8<<16>>16,w:a[c++],v:a[c++]}});else switch(d){case "keyRange":case "velRange":case "keynum":case "velocity":f.push({type:d,value:{w:a[c++],v:a[c++]}});break;default:f.push({type:d,value:{s:a[c++]|a[c++]<<8<<16>>16}})}c+=2;c+=2}return f}
function ha(a,b){a=a.input;var c=b.offset;b=b.offset+b.a;for(var e,d,f=[];c<b;)if(e=a[c++]|a[c++]<<8,d=ia[e],void 0===d)f.push({type:d,value:{code:e,s:a[c]|a[c+1]<<8<<16>>16,w:a[c++],v:a[c++]}});else switch(d){case "keynum":case "keyRange":case "velRange":case "velocity":f.push({type:d,value:{w:a[c++],v:a[c++]}});break;default:f.push({type:d,value:{s:a[c++]|a[c++]<<8<<16>>16}})}return f}
function L(a,b,c){var e=[],d={Ia:[],keyRange:{v:127,w:0}},f;for(f=a;f<b;++f)a=c[f],e.push(a),"unknown"===a.type?d.Ia.push(a.value):d[a.type]=a.value;return{L:d,M:e}}
var ia=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",,"chorusEffectsSend","reverbEffectsSend","pan",,,,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay",
"delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",,"scaleTuning","exclusiveClass","overridingRootKey","endOper"];function M(a,b,c){this.b=a;this.A=b;this.l=c;this.key=c.key;this.H=c.velocity;this.o=c.sample;this.i=c.basePlaybackRate;this.sampleRate=c.sampleRate;this.volume=c.volume;this.G=c.panpot;this.B=c.pitchBend;this.C=c.pitchBendSensitivity;this.u=c.modEnvToPitch;this.h=c.expression;this.D=a.currentTime;this.c=this.i|0;this.m=!1;this.g=Math.pow(2,1/12)}function N(a){return 440*Math.pow(2,(a-6900)/1200)}
function O(a){var b=a.l,c=a.j,e=a.f,d=a.b.currentTime,f=b.releaseTime-64;f=d+b.volRelease*e.gain.value*(1+f/(0>f?64:63));var g=a.P,h=N(b.initialFilterFc),k=N(b.initialFilterFc+b.modEnvToFilterFc);k=d+b.modRelease*(h===k?1:(g.frequency.value-h)/(k-h));if(a.F)switch(b.sampleModes){case 1:e.gain.cancelScheduledValues(0);e.gain.setValueAtTime(e.gain.value,d);e.gain.linearRampToValueAtTime(0,f);g.frequency.cancelScheduledValues(0);g.frequency.setValueAtTime(g.frequency.value,d);g.frequency.linearRampToValueAtTime(h,
k);c.playbackRate.cancelScheduledValues(0);c.playbackRate.setValueAtTime(c.playbackRate.value,d);c.playbackRate.linearRampToValueAtTime(a.c,k);c.stop(f);break;case 2:r.console.log("detect unused sampleModes");break;case 3:c.loop=!1}}M.prototype.connect=function(){this.f.connect(this.A)};M.prototype.disconnect=function(){this.f.disconnect(0)};
function ja(a,b){a.c=a.i*Math.pow(a.g,b/(0>b?8192:8191)*a.C*a.l.scaleTuning);b=a.j.playbackRate;var c=a.c,e=a.D,d=a.l,f=e+d.modAttack,g=f+d.modDecay;a=c*Math.pow(a.g,a.u*a.l.scaleTuning);b.cancelScheduledValues(0);b.setValueAtTime(c,e);b.linearRampToValueAtTime(a,f);b.linearRampToValueAtTime(c+(a-c)*(1-d.modSustain),g)};function P(a){var b;this.input=a;this.F={};this.$=0;this.m={};if(void 0!==r.AudioContext)a=new r.AudioContext;else if(void 0!==r.webkitAudioContext)a=new r.webkitAudioContext;else if(void 0!==r.mozAudioContext)a=new r.mozAudioContext;else throw Error("Web Audio not supported");void 0===a.createGainNode&&(a.createGainNode=a.createGain);this.b=a;this.h=this.b.createGain();this.A=this.b.createBufferSource();this.c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.W=[127,127,127,127,127,127,127,127,127,127,127,
127,127,127,127,127];this.T=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.D=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2];this.B=[127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127];this.V=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.C=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.g=[0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0];this.H=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.Z=[40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40];this.Y=[64,64,
64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.G=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.i=this.o=!1;this.S=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.f=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];this.oa=1/65535;this.a=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.j=Array(128);a=0;for(b=this.j.length;a<b;++a)this.j[a]=127;this.u=new B(this.b)}
function Q(a){var b;a.F=new J(a.input,{sampleRate:a.b.sampleRate});a.m=ka(a);a.i=!1;a.o=!1;for(b=0;16>b;++b)R(a,b,0),oa(a,b,100),pa(a,b,64),S(a,b,0,64),T(a,b,2),a.C[b]=!1,a.B[b]=127,a.g[b]=9===b?128:0,a.H[b]=0,a.a[b]=!1,a.Z[b]=40;for(b=0;128>b;++b)a.j[b]=127}P.prototype.close=function(){this.b.close()};
function ka(a){a=a.F;a.parse();var b=a.Aa,c=a.Ca,e=[],d,f;var g=0;for(f=b.length;g<f;++g){var h=b[g].ja;var k=b[g+1]?b[g+1].ja:c.length;for(d=[];h<k;++h){var n=L(c[h].ka,c[h+1]?c[h+1].ka:a.la.length,a.la);var p=n.L;var q=n.M;var x=L(c[h].R,c[h+1]?c[h+1].R:a.ma.length,a.ma);n=x.L;x=x.M;d.push({ca:p,ra:q,P:n,va:x});p=void 0!==p.instrument?p.instrument.s:void 0!==n.instrument?n.instrument.s:null}e.push({name:b[g].Ba,info:d,da:b[g],l:p})}c=a.l;d=a.ua;b=[];f=0;for(h=c.length;f<h;++f){k=c[f].ea;p=c[f+1]?
c[f+1].ea:d.length;g=[];for(n=p;k<n;++k){q=L(d[k].fa,d[k+1]?d[k+1].fa:a.ga.length,a.ga);p=q.L;x=q.M;var t=L(d[k].R,d[k+1]?d[k+1].sa:a.ha.length,a.ha);q=t.L;t=t.M;g.push({ca:p,ra:x,P:q,va:t})}b.push({name:c[f].ta,info:g})}c=[];f=0;for(h=e.length;f<h;++f)if(p=e[f],g=p.da.za,k=p.da.$,"number"==typeof p.l&&(d=b[p.l],"EOI"!==d.name.replace(/\0*$/,"")))for(void 0===c[k]&&(c[k]=[]),k=c[k],k[g]={},k[g].name=p.name,p=0,n=d.info.length;p<n;++p){var C=a,z=k[g],l=d.info[p].ca,D=Math.pow(2,1/12);if(void 0!==l.keyRange&&
void 0!==l.sampleID){var v=U(l,"delayVolEnv",-12E3);var y=U(l,"attackVolEnv",-12E3);var I=U(l,"holdVolEnv",-12E3);var E=U(l,"decayVolEnv",-12E3);var wa=U(l,"sustainVolEnv");var xa=U(l,"releaseVolEnv",-12E3);var ya=U(l,"delayModEnv",-12E3);var za=U(l,"attackModEnv",-12E3);var Aa=U(l,"holdModEnv",-12E3);var Ba=U(l,"decayModEnv",-12E3);var Ca=U(l,"sustainModEnv");var Da=U(l,"releaseModEnv",-12E3);var Ea=U(l,"coarseTune")+U(l,"fineTune")/100;var la=U(l,"scaleTuning",100)/100;var ma=U(l,"freqVibLFO");
q=U(l,"pan");t=l.keyRange.w;for(x=l.keyRange.v;t<=x;++t)if(!z[t]){var na=U(l,"sampleID");var K=C.Ea[na];z[t]={sample:C.Da[na],sampleRate:K.sampleRate,sampleModes:U(l,"sampleModes"),basePlaybackRate:Math.pow(D,(t-U(l,"overridingRootKey",K.wa)+Ea+K.ya/100)*la),modEnvToPitch:U(l,"modEnvToPitch")/100,scaleTuning:la,start:32768*U(l,"startAddrsCoarseOffset")+U(l,"startAddrsOffset"),end:32768*U(l,"endAddrsCoarseOffset")+U(l,"endAddrsOffset"),loopStart:K.Ha+32768*U(l,"startloopAddrsCoarseOffset")+U(l,"startloopAddrsOffset"),
loopEnd:K.qa+32768*U(l,"endloopAddrsCoarseOffset")+U(l,"endloopAddrsOffset"),volDelay:Math.pow(2,v/1200),volAttack:Math.pow(2,y/1200),volHold:Math.pow(2,I/1200)*Math.pow(2,(60-t)*U(l,"keynumToVolEnvHold")/1200),volDecay:Math.pow(2,E/1200)*Math.pow(2,(60-t)*U(l,"keynumToVolEnvDecay")/1200),volSustain:wa/1E3,volRelease:Math.pow(2,xa/1200),modDelay:Math.pow(2,ya/1200),modAttack:Math.pow(2,za/1200),modHold:Math.pow(2,Aa/1200)*Math.pow(2,(60-t)*U(l,"keynumToModEnvHold")/1200),modDecay:Math.pow(2,Ba/1200)*
Math.pow(2,(60-t)*U(l,"keynumToModEnvDecay")/1200),modSustain:Ca/1E3,modRelease:Math.pow(2,Da/1200),initialFilterFc:U(l,"initialFilterFc",13500),modEnvToFilterFc:U(l,"modEnvToFilterFc"),initialFilterQ:U(l,"initialFilterQ"),reverbEffectSend:U(l,"reverbEffectSend"),initialAttenuation:U(l,"initialAttenuation"),freqVibLFO:ma?8.176*Math.pow(2,ma/1200):void 0,pan:q?q/1200:void 0}}}}return c}function U(a,b,c){void 0===c&&(c=0);return a[b]?a[b].s:c}
P.prototype.start=function(){this.connect();V(this,16383);this.A.start(0)};function V(a,b){a.h.gain.value=b/16384*a.oa}P.prototype.connect=function(){this.A.connect(this.h);this.h.connect(this.b.destination);this.h.connect(this.u);this.u.connect(this.b.destination)};P.prototype.disconnect=function(){this.A.disconnect(0);this.h.disconnect(0);this.u.disconnect(0)};var W="Instrument;Vol;Pan;Bend;Range;GM Mode".split(";");
function qa(a){var b=r.window.document,c=a.table=b.createElement("table"),e=b.createElement("thead"),d=b.createElement("tbody"),f;e.appendChild(ra(W,!0));for(f=0;16>f;++f){var g=ra(W.length+128,!1);d.appendChild(g);var h=g.querySelector("td:nth-child(1)");var k=b.createElement("input");k.setAttribute("type","checkbox");k.addEventListener("change",function(a,c){return function(){var b=this.checked,d=a.f[c],e;if(a.S[c]=b)for(b=0,e=d.length;b<e;++b)d[b].disconnect();else for(b=0,e=d.length;b<e;++b)d[b].connect()}}(a,
f),!1);h.appendChild(k);var n=b.createElement("select");for(k=0;128>k;++k){var p=9!==f?aa[k]:A[k];var q=b.createElement("option");""!==p&&(q.textContent=p,q.value=k,n.appendChild(q))}h.appendChild(n);n.addEventListener("change",function(a,b){return function(c){R(a,b,c.target.value)}}(a,f),!1);n.selectedIndex=a.c[f];h=b.createElement("meter");h.min=0;h.max=127;h.value=64;h.textContent=64;g.querySelector("td:nth-child(3)").appendChild(h);h=b.createElement("meter");h.min=-8192;h.max=8192;h.value=0;h.textContent=
0;g.querySelector("td:nth-child(4)").appendChild(h);g=g.querySelectorAll("td:nth-last-child(-n+128)");for(k=0;128>k;++k)g[k].addEventListener("mousedown",function(a,b,c){return function(d){d.preventDefault();a.X=!0;X(a,b,c,127)}}(a,f,k)),g[k].addEventListener("mouseover",function(a,b,c){return function(d){d.preventDefault();a.X&&X(a,b,c,127)}}(a,f,k)),g[k].addEventListener("mouseout",function(a,b,c){return function(d){d.preventDefault();Y(a,b,c)}}(a,f,k)),g[k].addEventListener("mouseup",function(a,
b,c){return function(d){d.preventDefault();a.X=!1;Y(a,b,c)}}(a,f,k))}c.appendChild(e);c.appendChild(d);return c}function ra(a,b){var c=r.window.document,e=c.createElement("tr"),d=a instanceof Array,f,g=d?a.length:a;for(f=0;f<g;++f){var h=c.createElement(b?"th":"td");h.textContent=d&&void 0!==a[f]?a[f]:"";b&&g===f+1&&h.setAttribute("colspan",129);e.appendChild(h)}return e}
function X(a,b,c,e){var d=sa(a,b),f=a.m[d][a.c[b]];void 0===f&&(f=a.m[0][a.c[b]],r.console.warn("instrument not found: bank=%s instrument=%s channel=%s",d,a.c[b],b));if(void 0===f[c])r.console.warn("instrument not found: bank=%s instrument=%s channel=%s key=%s",d,a.c[b],b,c);else{d=f[c];var g=a.T[b]-64;d.channel=b;d.key=c;d.velocity=e;d.panpot=g/(0>g?64:63);d.volume=a.W[b]/127;d.pitchBend=a.U[b]-8192;d.expression=a.B[b];d.pitchBendSensitivity=Math.round(a.D[b]);d.mute=a.S[b];d.releaseTime=a.V[b];
d.cutOffFrequency=a.G[b];d.harmonicContent=a.Y[b];a.a[b]&&(42!==c&&44!==c||Y(a,b,46),80===c&&Y(a,b,81),f.volume*=a.j[c]/127);f=new M(a.b,a.h,d);var h=f.b;d=f.l;var k=f.o;g=f.b.currentTime;var n=g+d.volDelay,p=g+d.modDelay,q=n+d.volAttack+d.volHold,x=n+d.modAttack+d.modHold,t=q+d.volDecay,C=x+d.modDecay;var z=d.loopStart/f.sampleRate;var l=d.loopEnd/f.sampleRate;var D=d.start/f.sampleRate;var v=void 0!==d.pan?d.pan:f.G;k=k.subarray(0,k.length+d.end);var y=f.F=h.createBuffer(1,k.length,f.sampleRate);
y.getChannelData(0).set(k);k=f.j=h.createBufferSource();k.buffer=y;k.loop=d.sampleModes;k.loopStart=z;k.loopEnd=l;ja(f,f.B);z=f.f=h.createGain();l=z.gain;f.a=h.createGain();f.a.gain.value=f.h/127;y=h.createStereoPanner();y.pan.value=Math.sin(v*Math.PI/2);v=f.H/127*f.volume*(1-d.initialAttenuation/1E3);0>v&&(v=0);l.setValueAtTime(0,g).setValueAtTime(0,n).setTargetAtTime(v,n,d.volAttack).setValueAtTime(v,q).linearRampToValueAtTime(v*(1-d.volSustain),t);n=N(d.initialFilterFc);q=N(d.initialFilterFc+d.modEnvToFilterFc);
t=n+(q-n)*(1-d.modSustain);h=f.P=h.createBiquadFilter();h.Q.setValueAtTime(Math.pow(10,d.initialFilterQ/200),g);h.frequency.value=n;h.type="lowpass";h.frequency.setValueAtTime(n,g).setValueAtTime(n,p).setTargetAtTime(q,p,parseFloat(d.modAttack+1)).setValueAtTime(q,x).linearRampToValueAtTime(t,C);k.connect(h);h.connect(y);y.connect(f.a);f.a.connect(z);d.mute||f.connect();k.start(0,D);a.f[b].push(f);ta(a,b,c,e)}}
function Y(a,b,c){sa(a,b);var e,d=a.f[b],f=a.C[b];var g=0;for(e=d.length;g<e;++g){var h=d[g];h.key===c&&(h.m=!0,ta(a,b,c,0),f||(O(h),d.splice(g,1),--g,--e))}}function ta(a,b,c,e){a.table&&(a=a.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child("+(c+W.length+1)+")"),0===e?(a.classList.remove("note-on"),a.style.opacity=1):(a.classList.add("note-on"),a.style.opacity=e/127))}
function ua(a,b,c){var e=a.f[b];if(!(a.C[b]=64>c))for(b=0,c=e.length;b<c;++b)a=e[b],a.m&&(O(a),e.splice(b,1),--b,--c)}function R(a,b,c){a.table&&(a.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:first-child > select").value=c);a.c[b]=c}function oa(a,b,c){a.table&&(a.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(2)").textContent=c);a.W[b]=c}function va(a,b,c){var e,d=a.f[b];var f=0;for(e=d.length;f<e;++f){var g=d[f];g.a.gain.value=(g.h=c)/127}a.B[b]=c}
function pa(a,b,c){a.table&&(a.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(3) > meter").value=c,a.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(3) > meter").textContent=c);a.T[b]=c}
function S(a,b,c,e){c=c&127|(e&127)<<7;var d,f=a.f[b],g=c-8192;a.table&&(a.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(4) > meter").value=g,a.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(4) > meter").textContent=g);e=0;for(d=f.length;e<d;++e)ja(f[e],g);a.U[b]=c}function T(a,b,c){a.table&&(a.table.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(5)").textContent=c);a.D[b]=c}
function sa(a,b){if(9===b)return a.a[9]=!0,a.i?127:128;if(a.i)var c=64===a.g[b]?125:126===a.g[b]||127===a.g[b]?a.g[b]:0;else a.o?(c=0,a.a[b]&&(c=128)):c=0;a.a[b]&&void 0===A[a.c[b]]&&(a.c[b]=0);return c};function Z(a){this.j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.m=!1;this.g=function(){};this.o=this.pa.bind(this);this.a=!0;this.ba=void 0!==a.ba;this.cache=void 0!==a.cache;r.window.addEventListener("DOMContentLoaded",function(){this.m=!0}.bind(this),!1)}m=Z.prototype;
m.Ga=function(a){var b=r.window;this.m?Fa(this,a):b.addEventListener("DOMContentLoaded",function e(){b.removeEventListener("DOMContentLoaded",e,!1);Fa(this,a)}.bind(this),!1)};
function Fa(a,b){var c=r.window.opener?r.window.opener:r.window.parent;a.I();var e=a.b=new XMLHttpRequest;e.open("GET",b,!0);e.responseType="arraybuffer";e.addEventListener("load",function(a){var b=new Uint8Array(a.target.response);this.ia(b);"function"==u(this.g)&&this.g(a.target.response);this.b=null}.bind(a),!1);e.addEventListener("abort",function(){this.I()}.bind(a),!1);e.addEventListener("progress",function(a){a.lengthComputable&&c&&c.postMessage("link,progress,"+a.loaded+","+a.total,"*")}.bind(a),
!1);e.addEventListener("fetch",function(){});e.send()}m.I=function(){this.b&&(this.b.abort(),this.b=null)};m.ia=function(a){var b=r.window;this.I();if(this.h){var c=this.h;c.input=a;c.F=new J(a);c.m=ka(c)}else c=this.h=new P(a),this.ba||b.document.body.appendChild(qa(c)),Q(c),c.start(),b.addEventListener("message",this.o,!1);b.postMessage("link,ready","*")};
m.pa=function(a){var b="function"==u(a.data.split)?a.data.split(","):[],c=b!==[]?b.shift():"";a=r.window.opener?r.window.opener:r.window.parent;switch(c){case "midi":Ga(this,b.map(function(a){return parseInt(a,16)}));break;case "link":if(void 0!==a)switch(b=b.shift(),b){case "reqpatch":a.postMessage("link,patch","*");break;case "setpatch":case "ready":a.postMessage("link,ready","*");break;case "progress":a.postMessage("link,progress","*");break;default:r.console.error("unknown link message:",b)}}};
m.Fa=function(a){this.g=a};
function Ga(a,b){var c=b[0]&15,e=a.h;switch(b[0]&240){case 128:Y(e,c,b[1]);break;case 144:0<b[2]?X(e,c,b[1],b[2]):Y(e,c,b[1]);break;case 176:var d=b[2];switch(b[1]){case 0:e.g[c]=d;break;case 6:if(a.a)switch(a.f[c]){case 0:switch(a.c[c]){case 0:T(e,c,d)}}else switch(a.j[c]){case 26:e.j[a.i[c]]=d}break;case 38:if(a.a)switch(a.f[c]){case 0:switch(a.c[c]){case 0:T(e,c,e.D[c]+d/100)}}break;case 7:oa(e,c,d);break;case 10:pa(e,c,d);break;case 120:for(b=e.f[c];0<b.length;)a=b.shift(),Y(e,c,a.key),O(a),a.disconnect();
break;case 121:va(e,c,127);S(e,c,0,64);ua(e,c,0);break;case 32:e.H[c]=d;break;case 98:a.a=!1;a.i[c]=d;break;case 99:a.a=!1;a.j[c]=d;break;case 100:a.a=!0;a.c[c]=d;break;case 101:a.a=!0;a.f[c]=d;break;case 64:ua(e,c,d);break;case 11:va(e,c,d);break;case 71:e.G[c]=d;break;case 73:e.V[c]=d;break;case 74:e.Y[c]=d;break;case 91:e.Z[c]=d}break;case 192:R(e,c,b[1]);break;case 224:S(e,c,b[1],b[2]);break;case 240:switch(b[1]){case 126:127===b[2]&&9===b[3]&&1===b[4]&&(e.i=!1,e.o=!1,Q(e));break;case 127:switch(b[3]){case 4:switch(b[4]){case 1:V(e,
b[5]+(b[6]<<7))}}}switch(b[2]){case 67:8===b[5]&&(e.a[b[6]]=0!==b[7]?!0:!1);switch(b[7]){case 4:V(e,2*(b[8]<<7));break;case 126:Q(e),e.i=!0}break;case 65:switch(b[8]){case 4:V(e,b[9]<<7);break;case 127:Q(e);e.o=!0;break;case 21:c=b[7]-15,b=b[8],0===c?e.a[9]=0!==b?!0:!1:10<=c?e.a[c-1]=0!==b?!0:!1:e.a[c]=0!==b?!0:!1}}break;default:e.a[9]=!0}};w("SoundFont.WebMidiLink",Z);w("SoundFont.WebMidiLink.prototype.setup",Z.prototype.Ga);w("SoundFont.WebMidiLink.prototype.loadSoundFont",Z.prototype.ia);w("SoundFont.WebMidiLink.prototype.cancelLoading",Z.prototype.I);w("SoundFont.WebMidiLink.prototype.setLoadCallback",Z.prototype.Fa);}).call(this); //# sourceMappingURL=sf2synth.min.js.map
